(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function n(){(e(window).width()!==l||e(window).height()!==t||e(window).width()<=991)&&(e(u).each(function(){e(this).flexMenu({undo:!0}).flexMenu(this.options)}),l=e(window).width(),t=e(window).height())}function i(n){var i,o;i=e("li.flexMenu-viewMore.focus"),o=i.not(n),o.removeClass("focus").find("> ul").hide()}var o,l=e(window).width(),t=e(window).height(),u=[];e(window).resize(function(){clearTimeout(o),o=setTimeout(function(){n()},200)}),e.fn.flexMenu=function(n){var o,l=e.extend({threshold:2,cutoff:2,linkText:"More",linkTitle:"View More",linkTextAll:"Menu",linkTitleAll:"Open/Close Menu",shouldApply:function(){return!0},showOnHover:!0,popupAbsolute:!0,popupClass:"",undo:!1},n);return this.options=l,o=e.inArray(this,u),o>=0?u.splice(o,1):u.push(this),this.each(function(){function n(e){var n=Math.ceil(e.offset().top)>=M+v;return n}var o,t,u,f,s,r,d,a=e(this),p=a.find("> li"),h=p.first(),c=p.last(),w=p.length,M=Math.floor(h.offset().top),v=Math.floor(h.outerHeight(!0)),x=!1;if(n(c)&&w>l.threshold&&!l.undo&&a.is(":visible")&&l.shouldApply()){var g=e('<ul class="flexMenu-popup rd-navbar-dropdown"></ul>');for(g.addClass(l.popupClass),d=w;d>1;d--){if(o=a.find("> li:last-child"),t=n(o),d-1<=l.cutoff){e(a.children().get().reverse()).appendTo(g),x=!0;break}if(!t)break;o.appendTo(g)}x?a.append('<li class="flexMenu-viewMore flexMenu-allInPopup"><a href="" title="'+l.linkTitleAll+'">'+l.linkTextAll+'</a><span class="rd-navbar-submenu-toggle"></span></li>'):a.append('<li class="flexMenu-viewMore rd-navbar--has-dropdown rd-navbar-submenu"><a href="" title="'+l.linkTitle+'">'+l.linkText+'</a><span class="rd-navbar-submenu-toggle"></span></li>'),u=a.find("> li.flexMenu-viewMore"),n(u)&&a.find("> li:nth-last-child(2)").appendTo(g),g.children().each(function(e,n){g.prepend(n)}),u.append(g),f=a.find("> li.flexMenu-viewMore > a"),f.click(function(e){i(u),g.toggle(),u.toggleClass("focus"),e.preventDefault()}),l.showOnHover&&"undefined"!=typeof Modernizr&&!Modernizr.touch&&u.hover(function(){e(this).addClass("focus")},function(){e(this).removeClass("focus")})}else if(l.undo&&a.find("ul.flexMenu-popup")){for(r=a.find("ul.flexMenu-popup"),s=r.find("li").length,d=1;d<=s;d++)r.find("> li:first-child").appendTo(a);r.remove(),a.find("> li.flexMenu-viewMore").remove()}})}});